# Smart EBL - ESPHome Configuration
# Central Electroblock for Motorhomes
# Hardware: ESP32-WROVER-IE-N16R8

substitutions:
  name: smart-ebl
  friendly_name: "Smart EBL"

packages:
  basics: !include basics.yaml

esphome:
  name: ${name}
  friendly_name: ${friendly_name}
  platformio_options:
    board_build.flash_mode: dio
    board_build.f_flash: 80000000L

esp32:
  board: esp-wrover-kit
  framework:
    type: esp-idf
    version: recommended
  flash_size: 16MB

# Enable Home Assistant API
api:
  encryption:
    key: !secret api_encryption_key

# Bluetooth proxy for BLE devices (optional)
# esp32_ble_tracker:
# bluetooth_proxy:

# =============================================================================
# External Components
# =============================================================================

external_components:
  - source:
      type: local
      path: components
  - source: github://skrebber/esphome-truma_inetbox
    components: ["truma_inetbox"]

# =============================================================================
# I2C Bus Configuration
# =============================================================================

i2c:
  sda: GPIO21
  scl: GPIO22
  scan: true
  frequency: 400kHz

# =============================================================================
# UART Configuration
# =============================================================================

uart:
  # Nextion Display (directly on board serial connections)
  - id: uart_nextion
    tx_pin: GPIO17
    rx_pin: GPIO16
    baud_rate: 115200

  # LIN Bus via TJA1021T for Truma CP Plus
  - id: uart_lin
    tx_pin: GPIO13
    rx_pin: GPIO12
    baud_rate: 9600
    stop_bits: 2

# =============================================================================
# CAN Bus Configuration (RV-C)
# =============================================================================

canbus:
  - platform: esp32_can
    id: can_bus
    tx_pin: GPIO5
    rx_pin: GPIO4
    can_id: 0x100
    bit_rate: 250kbps
    on_frame:
      - can_id: 0x0
        can_id_mask: 0x0
        then:
          - lambda: |-
              // RV-C protocol handler - receive all frames
              // x is std::vector<uint8_t> containing the frame data
              ESP_LOGD("can", "Received CAN frame with %d bytes", x.size());

# =============================================================================
# Nextion Display
# =============================================================================

display:
  - platform: nextion
    id: nextion_display
    uart_id: uart_nextion
    update_interval: 5s
    lambda: |-
      // Update display with current values
      it.set_component_value("vBatt", id(voltage_battery).state * 10);
      it.set_component_value("vStarter", id(voltage_starter).state * 10);

# =============================================================================
# Truma iNetbox (CP Plus Heater Control via LIN)
# =============================================================================

truma_inetbox:
  id: truma
  uart_id: uart_lin
  on_heater_message:
    - lambda: |-
        ESP_LOGD("truma", "Received heater message");

# Truma Climate Controls
climate:
  # Room heating
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: ROOM
    name: "Truma Room Heating"
    id: truma_room

  # Water heating
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: WATER
    name: "Truma Water Heating"
    id: truma_water

# Truma Number Controls
number:
  # Target room temperature
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: TARGET_ROOM_TEMPERATURE
    name: "Truma Target Room Temp"
    id: truma_target_room_temp

  # Target water temperature
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: TARGET_WATER_TEMPERATURE
    name: "Truma Target Water Temp"
    id: truma_target_water_temp

  # Electric power level (for mix mode)
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: ELECTRIC_POWER_LEVEL
    name: "Truma Electric Power Level"
    id: truma_electric_power

# Truma Select Controls
select:
  # Energy mix selection (gas heaters)
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: HEATER_ENERGY_MIX_GAS
    name: "Truma Energy Mix"
    id: truma_energy_mix

  # Fan mode for Combi heaters
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: HEATER_FAN_MODE_COMBI
    name: "Truma Fan Mode"
    id: truma_fan_mode

# =============================================================================
# ADS7830 ADC Sensors (Custom Component)
# =============================================================================

ads7830:
  - id: adc_fuses_1
    address: 0x48
  - id: adc_fuses_2
    address: 0x49
  - id: adc_fuses_3
    address: 0x4A
  - id: adc_tanks
    address: 0x4B

# =============================================================================
# Voltage Sensors
# =============================================================================

sensor:
  # Battery voltage (via voltage divider)
  - platform: ads7830
    ads7830_id: adc_fuses_1
    channel: 0
    name: "Battery Voltage"
    id: voltage_battery
    unit_of_measurement: "V"
    accuracy_decimals: 2
    filters:
      - calibrate_linear:
          - 0.0 -> 0.0
          - 3.3 -> 16.0  # Adjust based on voltage divider ratio
    update_interval: 1s

  # Starter battery voltage
  - platform: ads7830
    ads7830_id: adc_fuses_1
    channel: 1
    name: "Starter Battery Voltage"
    id: voltage_starter
    unit_of_measurement: "V"
    accuracy_decimals: 2
    filters:
      - calibrate_linear:
          - 0.0 -> 0.0
          - 3.3 -> 16.0
    update_interval: 5s

  # Fuse monitoring - Light group
  - platform: ads7830
    ads7830_id: adc_fuses_1
    channel: 2
    name: "Fuse F4 Voltage"
    id: fuse_f4
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  - platform: ads7830
    ads7830_id: adc_fuses_1
    channel: 3
    name: "Fuse F5 Voltage"
    id: fuse_f5
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Tank sensors
  - platform: ads7830
    ads7830_id: adc_tanks
    channel: 0
    name: "Fresh Water Tank"
    id: tank_fresh
    unit_of_measurement: "%"
    accuracy_decimals: 0
    filters:
      - calibrate_linear:
          - 0.0 -> 0
          - 3.3 -> 100
    update_interval: 10s

  - platform: ads7830
    ads7830_id: adc_tanks
    channel: 1
    name: "Grey Water Tank"
    id: tank_grey
    unit_of_measurement: "%"
    accuracy_decimals: 0
    filters:
      - calibrate_linear:
          - 0.0 -> 0
          - 3.3 -> 100
    update_interval: 10s

  - platform: ads7830
    ads7830_id: adc_tanks
    channel: 2
    name: "Black Water Tank"
    id: tank_black
    unit_of_measurement: "%"
    accuracy_decimals: 0
    filters:
      - calibrate_linear:
          - 0.0 -> 0
          - 3.3 -> 100
    update_interval: 10s

  # -----------------------------------------------------------------------------
  # ADC Fuses 1 (0x48) - Remaining channels
  # -----------------------------------------------------------------------------

  # Fuse F6 - Permanent output 1 (30A)
  - platform: ads7830
    ads7830_id: adc_fuses_1
    channel: 4
    name: "Fuse F6 Voltage"
    id: fuse_f6
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Fuse F7 - Permanent output 2 (30A)
  - platform: ads7830
    ads7830_id: adc_fuses_1
    channel: 5
    name: "Fuse F7 Voltage"
    id: fuse_f7
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Fuse F8 - Permanent output 3 (30A)
  - platform: ads7830
    ads7830_id: adc_fuses_1
    channel: 6
    name: "Fuse F8 Voltage"
    id: fuse_f8
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Fuse F1 - Water pump (10A)
  - platform: ads7830
    ads7830_id: adc_fuses_1
    channel: 7
    name: "Fuse F1 Voltage"
    id: fuse_f1
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # -----------------------------------------------------------------------------
  # ADC Fuses 2 (0x49) - Fuse group 2
  # -----------------------------------------------------------------------------

  # Fuse F2 - Contour light (10A)
  - platform: ads7830
    ads7830_id: adc_fuses_2
    channel: 0
    name: "Fuse F2 Voltage"
    id: fuse_f2
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Fuse F3 - Awning light (10A)
  - platform: ads7830
    ads7830_id: adc_fuses_2
    channel: 1
    name: "Fuse F3 Voltage"
    id: fuse_f3
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Fuse F9 - Fridge permanent (30A)
  - platform: ads7830
    ads7830_id: adc_fuses_2
    channel: 2
    name: "Fuse F9 Voltage"
    id: fuse_f9
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Fuse F10 - Fridge D+ controlled (30A)
  - platform: ads7830
    ads7830_id: adc_fuses_2
    channel: 3
    name: "Fuse F10 Voltage"
    id: fuse_f10
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Fuse F11 - AUX group 1 (30A)
  - platform: ads7830
    ads7830_id: adc_fuses_2
    channel: 4
    name: "Fuse F11 Voltage"
    id: fuse_f11
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Fuse F12 - AUX group 2 (30A)
  - platform: ads7830
    ads7830_id: adc_fuses_2
    channel: 5
    name: "Fuse F12 Voltage"
    id: fuse_f12
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Fuse F13 - AUX group 3 (30A)
  - platform: ads7830
    ads7830_id: adc_fuses_2
    channel: 6
    name: "Fuse F13 Voltage"
    id: fuse_f13
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Fuse F14 - 12V group 1 (30A)
  - platform: ads7830
    ads7830_id: adc_fuses_2
    channel: 7
    name: "Fuse F14 Voltage"
    id: fuse_f14
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # -----------------------------------------------------------------------------
  # ADC Fuses 3 (0x4A) - Fuse group 3
  # -----------------------------------------------------------------------------

  # Fuse F15 - 12V group 2 (30A)
  - platform: ads7830
    ads7830_id: adc_fuses_3
    channel: 0
    name: "Fuse F15 Voltage"
    id: fuse_f15
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Fuse F16 - 12V group 3 (30A)
  - platform: ads7830
    ads7830_id: adc_fuses_3
    channel: 1
    name: "Fuse F16 Voltage"
    id: fuse_f16
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Output monitoring - Light group output
  - platform: ads7830
    ads7830_id: adc_fuses_3
    channel: 2
    name: "Light Output Voltage"
    id: voltage_light_out
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Output monitoring - 12V group output
  - platform: ads7830
    ads7830_id: adc_fuses_3
    channel: 3
    name: "12V Output Voltage"
    id: voltage_12v_out
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Output monitoring - AUX group output
  - platform: ads7830
    ads7830_id: adc_fuses_3
    channel: 4
    name: "AUX Output Voltage"
    id: voltage_aux_out
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Output monitoring - Pump output
  - platform: ads7830
    ads7830_id: adc_fuses_3
    channel: 5
    name: "Pump Output Voltage"
    id: voltage_pump_out
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Output monitoring - EisEx output
  - platform: ads7830
    ads7830_id: adc_fuses_3
    channel: 6
    name: "EisEx Output Voltage"
    id: voltage_eisex
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 5s

  # Spare ADC channel
  - platform: ads7830
    ads7830_id: adc_fuses_3
    channel: 7
    name: "ADC Spare 1"
    id: adc_spare_1
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 10s
    internal: true

  # -----------------------------------------------------------------------------
  # ADC Tanks (0x4B) - Remaining channels
  # -----------------------------------------------------------------------------

  # Duocontrol gas system status
  - platform: ads7830
    ads7830_id: adc_tanks
    channel: 3
    name: "Duocontrol Voltage"
    id: duocontrol_voltage
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 10s

  # Shore power voltage level
  - platform: ads7830
    ads7830_id: adc_tanks
    channel: 4
    name: "Shore Power Voltage"
    id: shore_power_voltage
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 10s

  # Spare analog inputs
  - platform: ads7830
    ads7830_id: adc_tanks
    channel: 5
    name: "Analog Input 1"
    id: analog_input_1
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 10s

  - platform: ads7830
    ads7830_id: adc_tanks
    channel: 6
    name: "Analog Input 2"
    id: analog_input_2
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 10s

  - platform: ads7830
    ads7830_id: adc_tanks
    channel: 7
    name: "Analog Input 3"
    id: analog_input_3
    unit_of_measurement: "V"
    accuracy_decimals: 2
    update_interval: 10s

  # -----------------------------------------------------------------------------
  # Fuse Status Binary Sensors (derived from voltage)
  # -----------------------------------------------------------------------------

  # WiFi signal strength
  - platform: wifi_signal
    name: "WiFi Signal"
    update_interval: 60s

  # ESP32 internal temperature
  - platform: internal_temperature
    name: "ESP32 Temperature"
    update_interval: 60s

  # Uptime sensor
  - platform: uptime
    name: "Uptime"
    update_interval: 60s

  # ---------------------------------------------------------------------------
  # Truma Heater Sensors
  # ---------------------------------------------------------------------------

  # Current room temperature
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: CURRENT_ROOM_TEMPERATURE
    name: "Truma Current Room Temp"
    id: truma_current_room_temp

  # Current water temperature
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: CURRENT_WATER_TEMPERATURE
    name: "Truma Current Water Temp"
    id: truma_current_water_temp

  # Heating mode
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: HEATING_MODE
    name: "Truma Heating Mode"
    id: truma_heating_mode

  # Operating status
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: OPERATING_STATUS
    name: "Truma Operating Status"
    id: truma_operating_status

  # Heater error code
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: HEATER_ERROR_CODE
    name: "Truma Error Code"
    id: truma_error_code

# =============================================================================
# Fuse Status (Binary Sensors derived from voltage readings)
# =============================================================================

binary_sensor:
  # Fuse blown detection - voltage below threshold indicates blown fuse
  - platform: template
    name: "Fuse F1 OK"
    id: fuse_f1_ok
    lambda: |-
      return id(fuse_f1).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F2 OK"
    id: fuse_f2_ok
    lambda: |-
      return id(fuse_f2).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F3 OK"
    id: fuse_f3_ok
    lambda: |-
      return id(fuse_f3).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F4 OK"
    id: fuse_f4_ok
    lambda: |-
      return id(fuse_f4).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F5 OK"
    id: fuse_f5_ok
    lambda: |-
      return id(fuse_f5).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F6 OK"
    id: fuse_f6_ok
    lambda: |-
      return id(fuse_f6).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F7 OK"
    id: fuse_f7_ok
    lambda: |-
      return id(fuse_f7).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F8 OK"
    id: fuse_f8_ok
    lambda: |-
      return id(fuse_f8).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F9 OK"
    id: fuse_f9_ok
    lambda: |-
      return id(fuse_f9).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F10 OK"
    id: fuse_f10_ok
    lambda: |-
      return id(fuse_f10).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F11 OK"
    id: fuse_f11_ok
    lambda: |-
      return id(fuse_f11).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F12 OK"
    id: fuse_f12_ok
    lambda: |-
      return id(fuse_f12).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F13 OK"
    id: fuse_f13_ok
    lambda: |-
      return id(fuse_f13).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F14 OK"
    id: fuse_f14_ok
    lambda: |-
      return id(fuse_f14).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F15 OK"
    id: fuse_f15_ok
    lambda: |-
      return id(fuse_f15).state > 1.0;
    device_class: power

  - platform: template
    name: "Fuse F16 OK"
    id: fuse_f16_ok
    lambda: |-
      return id(fuse_f16).state > 1.0;
    device_class: power

  # ---------------------------------------------------------------------------
  # Truma Binary Sensors
  # ---------------------------------------------------------------------------

  # CP Plus connected
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: CP_PLUS_CONNECTED
    name: "Truma CP Plus Connected"
    id: truma_connected

  # Room heater active
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: HEATER_ROOM
    name: "Truma Room Heater Active"
    id: truma_heater_room

  # Water heater active
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: HEATER_WATER
    name: "Truma Water Heater Active"
    id: truma_heater_water

  # Gas heater mode
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: HEATER_GAS
    name: "Truma Gas Mode"
    id: truma_gas_mode

  # Electric/Mix mode
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: HEATER_ELECTRICITY
    name: "Truma Electric Mode"
    id: truma_electric_mode

  # Heater has error
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: HEATER_HAS_ERROR
    name: "Truma Has Error"
    id: truma_has_error
    device_class: problem

  # Timer active
  - platform: truma_inetbox
    truma_inetbox_id: truma
    type: TIMER_ACTIVE
    name: "Truma Timer Active"
    id: truma_timer_active

  # ---------------------------------------------------------------------------
  # GPIO Binary Inputs
  # ---------------------------------------------------------------------------

  # D+ Signal from vehicle (engine running)
  - platform: gpio
    pin:
      number: GPIO34
      mode: INPUT
    name: "D+ Signal"
    id: d_plus_signal
    device_class: running
    filters:
      - delayed_on: 100ms
      - delayed_off: 1s
    # on_press action disabled - relay_light unavailable (GPIO12/13 used for LIN/Truma)
    # on_press:
    #   - switch.turn_off: relay_light

  # Shore power detection
  - platform: gpio
    pin:
      number: GPIO35
      mode: INPUT
    name: "Shore Power"
    id: shore_power
    device_class: plug
    filters:
      - delayed_on: 500ms

  # Physical buttons on board
  - platform: gpio
    pin:
      number: GPIO0
      mode: INPUT_PULLUP
      inverted: true
    name: "Mode Button"
    id: btn_mode

  - platform: gpio
    pin:
      number: GPIO36
      mode: INPUT
    name: "Pump On Button"
    id: btn_pump_on
    on_press:
      - switch.turn_on: relay_pump

  - platform: gpio
    pin:
      number: GPIO39
      mode: INPUT
    name: "Pump Off Button"
    id: btn_pump_off
    on_press:
      - switch.turn_off: relay_pump

# =============================================================================
# Relay Outputs (via ULN2803A)
# =============================================================================

# Bistable relay control requires pulse to toggle
# We use output components with switches that pulse

output:
  # Light group ON/OFF coils - DISABLED (GPIO12/13 used for LIN/Truma)
  # - platform: gpio
  #   id: relay_light_on_coil
  #   pin: GPIO13
  # - platform: gpio
  #   id: relay_light_off_coil
  #   pin: GPIO12

  # 12V group ON coil
  - platform: gpio
    id: relay_12v_on_coil
    pin: GPIO14

  # 12V group OFF coil
  - platform: gpio
    id: relay_12v_off_coil
    pin: GPIO27

  # AUX group ON coil
  - platform: gpio
    id: relay_aux_on_coil
    pin: GPIO26

  # AUX group OFF coil
  - platform: gpio
    id: relay_aux_off_coil
    pin: GPIO25

  # Pump relay ON coil
  - platform: gpio
    id: relay_pump_on_coil
    pin: GPIO32

  # Pump relay OFF coil
  - platform: gpio
    id: relay_pump_off_coil
    pin: GPIO33

  # EisEx heater (via BTS6143D)
  - platform: gpio
    id: output_eisex
    pin: GPIO15

  # CAN termination
  - platform: gpio
    id: can_termination
    pin: GPIO2

switch:
  # Bistable relay: Light Group - DISABLED (GPIO12/13 used for LIN/Truma)
  # - platform: template
  #   name: "Light Group"
  #   id: relay_light
  #   icon: mdi:lightbulb-group
  #   optimistic: true
  #   turn_on_action:
  #     - output.turn_on: relay_light_on_coil
  #     - delay: 50ms
  #     - output.turn_off: relay_light_on_coil
  #   turn_off_action:
  #     - output.turn_on: relay_light_off_coil
  #     - delay: 50ms
  #     - output.turn_off: relay_light_off_coil

  # Bistable relay: 12V Group
  - platform: template
    name: "12V Group"
    id: relay_12v
    icon: mdi:power-socket-eu
    optimistic: true
    turn_on_action:
      - output.turn_on: relay_12v_on_coil
      - delay: 50ms
      - output.turn_off: relay_12v_on_coil
    turn_off_action:
      - output.turn_on: relay_12v_off_coil
      - delay: 50ms
      - output.turn_off: relay_12v_off_coil

  # Bistable relay: AUX Group
  - platform: template
    name: "AUX Group"
    id: relay_aux
    icon: mdi:power
    optimistic: true
    turn_on_action:
      - output.turn_on: relay_aux_on_coil
      - delay: 50ms
      - output.turn_off: relay_aux_on_coil
    turn_off_action:
      - output.turn_on: relay_aux_off_coil
      - delay: 50ms
      - output.turn_off: relay_aux_off_coil

  # Bistable relay: Water Pump
  - platform: template
    name: "Water Pump"
    id: relay_pump
    icon: mdi:water-pump
    optimistic: true
    turn_on_action:
      - output.turn_on: relay_pump_on_coil
      - delay: 50ms
      - output.turn_off: relay_pump_on_coil
    turn_off_action:
      - output.turn_on: relay_pump_off_coil
      - delay: 50ms
      - output.turn_off: relay_pump_off_coil

  # EisEx Heater
  - platform: output
    name: "EisEx Heater"
    id: switch_eisex
    output: output_eisex
    icon: mdi:heating-coil

  # CAN Bus Termination
  - platform: output
    name: "CAN Termination"
    id: switch_can_term
    output: can_termination
    icon: mdi:resistor

# =============================================================================
# Text Sensors
# =============================================================================

text_sensor:
  - platform: version
    name: "ESPHome Version"

  - platform: wifi_info
    ip_address:
      name: "IP Address"
    ssid:
      name: "Connected SSID"
